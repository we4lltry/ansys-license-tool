<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="utf-8" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: transparent;
      font-family: 'Noto Sans KR', sans-serif;
      overflow: hidden;
    }

    #wrap {
      display: flex;
      gap: 8px;
      align-items: center;
      width: 100%;
      height: 40px;
    }

    #addr-input {
      flex: 1;
      padding: 8px 12px;
      background: #080c1a;
      border: 1px solid #141d40;
      border-radius: 9px;
      color: #c5c8d8;
      font-size: 14px;
      cursor: pointer;
      outline: none;
      transition: border-color .2s;
    }

    #addr-input:hover,
    #addr-input:focus {
      border-color: #b8922a;
      box-shadow: 0 0 0 2px rgba(184, 146, 42, .12);
    }

    #addr-input::placeholder {
      color: #4a5070;
    }

    #search-btn {
      padding: 8px 14px;
      background: #b8922a;
      color: #05080f;
      border: none;
      border-radius: 9px;
      font-size: 13px;
      font-weight: 700;
      cursor: pointer;
      white-space: nowrap;
      transition: background .2s, transform .15s;
    }

    #search-btn:hover {
      background: #c9a23a;
    }

    /* Postcode Embed ë ˆì´ì–´ */
    #layer {
      display: none;
      position: relative;
      width: 100%;
      height: 400px;
      margin-top: 8px;
      border: 2px solid #b8922a;
      border-radius: 8px;
      background: #fff;
      overflow: hidden;
      z-index: 9999;
    }

    #close-btn {
      cursor: pointer;
      position: absolute;
      right: 4px;
      top: 4px;
      z-index: 10000;
      border: none;
      background: #333;
      color: #fff;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
    }
  </style>
</head>

<body>
  <div id="wrap">
    <input id="addr-input" type="text" placeholder="ğŸ” í´ë¦­í•˜ê±°ë‚˜ ê²€ìƒ‰ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”" readonly />
    <button id="search-btn" onclick="openPostcode()">ì£¼ì†Œ ê²€ìƒ‰</button>
  </div>
  <div id="layer">
    <button id="close-btn" onclick="closePostcode()">ë‹«ê¸°</button>
  </div>

  <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
  <script>
    function sendToStreamlit(type, data) {
      window.parent.postMessage(Object.assign({ type }, data), '*');
    }
    function setComponentValue(value) {
      sendToStreamlit('streamlit:setComponentValue', { value });
    }
    function setFrameHeight(h) {
      sendToStreamlit('streamlit:setFrameHeight', { height: h });
    }

    sendToStreamlit('streamlit:componentReady', { apiVersion: 1 });

    window.addEventListener('message', function (e) {
      if (e.data.type === 'streamlit:render') {
        var args = e.data.args || {};
        if (args.value) {
          document.getElementById('addr-input').value = args.value;
        }
        // ê¸°ë³¸ ë Œë”ë§ ì‹œ ë†’ì´ëŠ” 45px
        if (document.getElementById('layer').style.display !== 'block') {
          setFrameHeight(45);
        }
      }
    });

    var element_layer = document.getElementById('layer');

    function closePostcode() {
      element_layer.style.display = 'none';
      setFrameHeight(45);
    }

    function openPostcode() {
      // ë ˆì´ì–´ í‘œì‹œ ë° Streamlit í”„ë ˆì„ ë†’ì´ 460ìœ¼ë¡œ ëŠ˜ë¦¼ (ì…ë ¥ì°½ 45 + ì—¬ë°± + ë ˆì´ì–´ 400)
      element_layer.style.display = 'block';
      setFrameHeight(460);

      new daum.Postcode({
        oncomplete: function (data) {
          var addr = data.roadAddress || data.jibunAddress || data.address;
          document.getElementById('addr-input').value = addr;
          setComponentValue(addr);

          // ì™„ë£Œ í›„ ë ˆì´ì–´ ìˆ¨ê¸°ê³  ë‹¤ì‹œ ì¶•ì†Œ
          closePostcode();
        },
        width: '100%',
        height: '100%',
        maxSuggestItems: 5
      }).embed(element_layer);
    }

    document.getElementById('addr-input').addEventListener('click', openPostcode);
  </script>
</body>

</html>